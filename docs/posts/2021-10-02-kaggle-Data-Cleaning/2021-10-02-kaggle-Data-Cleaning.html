<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Siyun Min">
<meta name="dcterms.date" content="2021-10-02">

<title>Siyun Min - Kaggle - Data Clearning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Siyun Min</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">Siyun Min</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sy9777m"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kevinmin77/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Kaggle - Data Clearning</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Kaggle</div>
                <div class="quarto-category">Python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Siyun Min </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 2, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="kaggle-data-cleaning" class="level1">
<h1>kaggle Data Cleaning</h1>
<section id="handling-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-values">Handling Missing Values</h2>
<section id="how-many-missing-data-points-do-we-have" class="level3">
<h3 class="anchored" data-anchor-id="how-many-missing-data-points-do-we-have">How many missing data points do we have?</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the number of missing data points per column</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>missing_values_count <span class="op">=</span> nfl_data.isnull().<span class="bu">sum</span>()</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the # of missing points in the first ten columns</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>missing_values_count[<span class="dv">0</span>:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code># how many total missing values do we have?
total_cells = np.product(nfl_data.shape)
total_missing = missing_values_count.sum()

# percent of data that is missing
percent_missing = (total_missing/total_cells) * 100
print(percent_missing)</code></pre>
</section>
<section id="figure-out-why-the-data-is-missing" class="level3">
<h3 class="anchored" data-anchor-id="figure-out-why-the-data-is-missing">Figure out why the data is missing</h3>
<p>This is the point at which we get into the part of data science that I like to call “data intution”, by which I mean “really looking at your data and trying to figure out why it is the way it is and how that will affect your analysis”.</p>
<p>For dealing with missing values, you’ll need to use your intution to figure out why the value is missing. One of the most important questions you can ask yourself to help figure this out is this:</p>
<blockquote class="blockquote">
<p><strong>Is this value missing because it wasn’t recorded or because it doesn’t exist?</strong></p>
</blockquote>
<p>If a value is missing becuase it doesn’t exist (like the height of the oldest child of someone who doesn’t have any children) then it doesn’t make sense to try and guess what it might be. These values you probably do want to keep as <code>NaN</code>. On the other hand, if a value is missing because it wasn’t recorded, then you can try to guess what it might have been based on the other values in that column and row. This is called <strong>imputation</strong>.</p>
<p>If you’re doing very careful data analysis, this is the point at which you’d look at each column individually to figure out the best strategy for filling those missing values.</p>
</section>
<section id="drop-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="drop-missing-values">Drop missing values</h3>
<p>If you’re in a hurry or don’t have a reason to figure out why your values are missing, one option you have is to just remove any rows or columns that contain missing values. (Note: I don’t generally recommend this approch for important projects! It’s usually worth it to take the time to go through your data and really look at all the columns with missing values one-by-one to really get to know your dataset.)</p>
<p>If you’re sure you want to drop rows with missing values, pandas does have a handy function, <code>dropna()</code> to help you do this.</p>
</section>
<section id="filling-in-missing-values-automatically" class="level3">
<h3 class="anchored" data-anchor-id="filling-in-missing-values-automatically">Filling in missing values automatically</h3>
<p>We can use the Panda’s <code>fillna()</code> function to fill in missing values in a dataframe for us. One option we have is to specify what we want the <code>NaN</code> values to be replaced with.</p>
<p>I could also be a bit more savvy and replace missing values with whatever value comes directly after it in the same column. (This makes a lot of sense for datasets where the observations have some sort of logical order to them.)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace all NA's the value that comes directly after it in the same column, </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># then replace all the remaining na's with 0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>subset_nfl_data.fillna(method<span class="op">=</span><span class="st">'bfill'</span>, axis<span class="op">=</span><span class="dv">0</span>).fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">Exercise</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Your code here!</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sf_permits.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Your code here!</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>percent_missing <span class="op">=</span> sf_permits.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">/</span> np.product(sf_permits.shape) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your answer</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>q2.check()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002030542339.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002030542339</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002030629934.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002030629934</figcaption><p></p>
</figure>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Your code here</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sf_permits_with_na_dropped <span class="op">=</span> sf_permits.dropna(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>dropped_columns <span class="op">=</span> <span class="bu">len</span>(sf_permits.columns) <span class="op">-</span> <span class="bu">len</span>(sf_permits_with_na_dropped.columns)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your answer</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>q5.check()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Your code here</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sf_permits_with_na_imputed <span class="op">=</span> sf_permits.fillna(method<span class="op">=</span><span class="st">'bfill'</span>, axis<span class="op">=</span><span class="dv">0</span>).fillna(<span class="dv">0</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your answer</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>q6.check()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="scaling-and-normalization" class="level2">
<h2 class="anchored" data-anchor-id="scaling-and-normalization">Scaling and Normalization</h2>
<section id="scaling-vs.-normalization-whats-the-difference" class="level3">
<h3 class="anchored" data-anchor-id="scaling-vs.-normalization-whats-the-difference">Scaling vs.&nbsp;Normalization: What’s the difference?</h3>
<ul>
<li>in <strong>scaling</strong>, you’re changing the <em>range</em> of your data, while</li>
<li>in <strong>normalization</strong>, you’re changing the <em>shape of the distribution</em> of your data.</li>
</ul>
</section>
<section id="scaling" class="level3">
<h3 class="anchored" data-anchor-id="scaling">Scaling</h3>
<p>This means that you’re transforming your data so that it fits within a specific scale, like 0-100 or 0-1.</p>
<p>By scaling your variables, you can help compare different variables on equal footing.</p>
<p>Notice that the <em>shape</em> of the data doesn’t change, but that instead of ranging from 0 to 8ish, it now ranges from 0 to 1.</p>
</section>
<section id="normalization" class="level3">
<h3 class="anchored" data-anchor-id="normalization">Normalization</h3>
<p>Normalization is a more radical transformation. The point of normalization is to change your observations so that they can be described as a normal distribution.</p>
<p>In general, you’ll normalize your data if you’re going to be using a machine learning or statistics technique that assumes your data is normally distributed</p>
<p>Notice that the <em>shape</em> of our data has changed. Before normalizing it was almost L-shaped. But after normalizing it looks more like the outline of a bell (hence “bell curve”).</p>
</section>
<section id="exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1">Exercise</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Your code here</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>scaled_goal_data <span class="op">=</span> minmax_scaling(original_goal_data, [<span class="st">'goal'</span>], <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your answer</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>q1.check()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="parsing-dates" class="level2">
<h2 class="anchored" data-anchor-id="parsing-dates">Parsing Dates</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002032243408.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002032243408</figcaption><p></p>
</figure>
</div>
<p>Notice that at the bottom of the output of <code>head()</code>, you can see that it says that the data type of this column is “object”.</p>
<blockquote class="blockquote">
<p>Pandas uses the “object” dtype for storing various types of data types, but most often when you see a column with the dtype “object” it will have strings in it.</p>
</blockquote>
<p>If you check the pandas dtype documentation <a href="http://pandas.pydata.org/pandas-docs/stable/basics.html#dtypes">here</a>, you’ll notice that there’s also a specific <code>datetime64</code> dtypes. Because the dtype of our column is <code>object</code> rather than <code>datetime64</code>, we can tell that Python doesn’t know that this column contains dates.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002032324133.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002032324133</figcaption><p></p>
</figure>
</div>
<p>You may have to check the <a href="https://docs.scipy.org/doc/numpy-1.12.0/reference/generated/numpy.dtype.kind.html#numpy.dtype.kind">numpy documentation</a> to match the letter code to the dtype of the object. “O” is the code for “object”, so we can see that these two methods give us the same information.</p>
<section id="convert-our-date-columns-to-datetime" class="level3">
<h3 class="anchored" data-anchor-id="convert-our-date-columns-to-datetime">Convert our date columns to datetime</h3>
<p>We can pandas what the format of our dates are with a guide called as <a href="http://strftime.org/">“strftime directive”, which you can find more information on at this link</a>. The basic idea is that you need to point out which parts of the date are where and what punctuation is between them. There are <a href="http://strftime.org/">lots of possible parts of a date</a>, but the most common are <code>%d</code> for day, <code>%m</code> for month, <code>%y</code> for a two-digit year and <code>%Y</code> for a four digit year.</p>
<p>Some examples:</p>
<ul>
<li>1/17/07 has the format “%m/%d/%y”</li>
<li>17-1-2007 has the format “%d-%m-%Y”</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002032411835.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002032411835</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002032419381.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002032419381</figcaption><p></p>
</figure>
</div>
<ul>
<li><strong>What if I run into an error with multiple date formats?</strong> While we’re specifying the date format here, sometimes you’ll run into an error when there are multiple date formats in a single column. If that happens, you have have pandas try to infer what the right date format should be. You can do that like so:</li>
</ul>
<pre><code>landslides['date_parsed'] = pd.to_datetime(landslides['Date'], infer_datetime_format=True)</code></pre>
<ul>
<li><strong>Why don’t you always use <code>infer_datetime_format = True?</code></strong> There are two big reasons not to always have pandas guess the time format. The first is that pandas won’t always been able to figure out the correct date format, especially if someone has gotten creative with data entry. The second is that it’s much slower than specifying the exact format of the dates.</li>
</ul>
</section>
<section id="selecting-the-day-of-the-month" class="level3">
<h3 class="anchored" data-anchor-id="selecting-the-day-of-the-month">Selecting the day of the month</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002032513853.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002032513853</figcaption><p></p>
</figure>
</div>
</section>
<section id="plot-the-day-of-the-month-to-check-the-date-parsing" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-day-of-the-month-to-check-the-date-parsing">Plot the day of the month to check the date parsing</h3>
<p>One of the biggest dangers in parsing dates is mixing up the months and days. The <code>to_datetime()</code> function does have very helpful error messages, but it doesn’t hurt to double-check that the days of the month we’ve extracted make sense.</p>
<p>To do this, let’s plot a histogram of the days of the month. We expect it to have values between 1 and 31 and, since there’s no reason to suppose the landslides are more common on some days of the month than others, a relatively even distribution. (With a dip on 31 because not all months have 31 days.) Let’s see if that’s the case:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002032619957.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002032619957</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="character-encodings" class="level2">
<h2 class="anchored" data-anchor-id="character-encodings">Character Encodings</h2>
<section id="what-are-encodings" class="level3">
<h3 class="anchored" data-anchor-id="what-are-encodings">What are encodings?</h3>
<p><strong>Character encodings</strong> are specific sets of rules for mapping from raw binary byte strings (that look like this: 0110100001101001) to characters that make up human-readable text (like “hi”). There are many different encodings, and if you tried to read in text with a different encoding than the one it was originally written in, you ended up with scrambled text called “mojibake” (said like mo-gee-bah-kay). Here’s an example of mojibake:</p>
<p>æ–‡å—åŒ–ã??</p>
<p>You might also end up with a “unknown” characters. There are what gets printed when there’s no mapping between a particular byte and a character in the encoding you’re using to read your byte string in and they look like this:</p>
<p>����������</p>
<p>Character encoding mismatches are less common today than they used to be, but it’s definitely still a problem. There are lots of different character encodings, but the main one you need to know is UTF-8.</p>
<blockquote class="blockquote">
<p>UTF-8 is <strong>the</strong> standard text encoding. All Python code is in UTF-8 and, ideally, all your data should be as well. It’s when things aren’t in UTF-8 that you run into trouble.</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002033900935.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002033900935</figcaption><p></p>
</figure>
</div>
<p>If you look at a bytes object, you’ll see that it has a b in front of it, and then maybe some text after. That’s because bytes are printed out as if they were characters encoded in ASCII. (ASCII is an older character encoding that doesn’t really work for writing any language other than English.) Here you can see that our euro symbol has been replaced with some mojibake that looks like “” when it’s printed as if it were an ASCII string.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002033947123.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002033947123</figcaption><p></p>
</figure>
</div>
<p>However, when we try to use a different encoding to map our bytes into a string, we get an error. This is because the encoding we’re trying to use doesn’t know what to do with the bytes we’re trying to pass it. You need to tell Python the encoding that the byte string is actually supposed to be in.</p>
<p>Like I said earlier, strings are UTF-8 by default in Python 3, so if we try to treat them like they were in another encoding we’ll create problems.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002034050924.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002034050924</figcaption><p></p>
</figure>
</div>
</section>
<section id="reading-in-files-with-encoding-problems" class="level3">
<h3 class="anchored" data-anchor-id="reading-in-files-with-encoding-problems">Reading in files with encoding problems</h3>
<p>Notice that we get the same <code>UnicodeDecodeError</code> we got when we tried to decode UTF-8 bytes as if they were ASCII! This tells us that this file isn’t actually UTF-8. We don’t know what encoding it actually <em>is</em> though. One way to figure it out is to try and test a bunch of different character encodings and see if any of them work. A better way, though, is to use the chardet module to try and automatically guess what the right encoding is. It’s not 100% guaranteed to be right, but it’s usually faster than just trying to guess.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002034205908.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002034205908</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002034214164.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002034214164</figcaption><p></p>
</figure>
</div>
<p><strong>What if the encoding chardet guesses isn’t right?</strong> Since chardet is basically just a fancy guesser, sometimes it will guess the wrong encoding. One thing you can try is looking at more or less of the file and seeing if you get a different result and then try that.</p>
</section>
<section id="saving-your-files-with-utf-8-encoding" class="level3">
<h3 class="anchored" data-anchor-id="saving-your-files-with-utf-8-encoding">Saving your files with UTF-8 encoding</h3>
<p>The good news is, since UTF-8 is the standard encoding in Python, when you save a file it will be saved as UTF-8 by default:</p>
</section>
<section id="exercise-2" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2">Exercise</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>new_entry <span class="op">=</span> sample_entry.decode(<span class="st">'big5-tw'</span>).encode(<span class="st">'utf-8'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your answer</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>q1.check()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Load in the DataFrame correctly.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../input/fatal-police-shootings-in-the-us/PoliceKillingsUS.csv"</span>, <span class="st">'rb'</span>) <span class="im">as</span> rawdata:</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> chardet.detect(rawdata.read(<span class="dv">30000</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>police_killings <span class="op">=</span> pd.read_csv(<span class="st">"../input/fatal-police-shootings-in-the-us/PoliceKillingsUS.csv"</span>, encoding<span class="op">=</span><span class="st">'Windows-1252'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your answer</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>q2.check()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Save the police killings dataset to CSV</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>police_killings.to_csv(<span class="st">"/kaggle/working/my_file.csv"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your answer</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>q3.check()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="inconsistent-data-entry" class="level2">
<h2 class="anchored" data-anchor-id="inconsistent-data-entry">Inconsistent Data Entry</h2>
<section id="do-some-preliminary-text-pre-processing" class="level3">
<h3 class="anchored" data-anchor-id="do-some-preliminary-text-pre-processing">Do some preliminary text pre-processing</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002035130731.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002035130731</figcaption><p></p>
</figure>
</div>
</section>
<section id="use-fuzzy-matching-to-correct-inconsistent-data-entry" class="level3">
<h3 class="anchored" data-anchor-id="use-fuzzy-matching-to-correct-inconsistent-data-entry">Use fuzzy matching to correct inconsistent data entry</h3>
<p>We’re going to use the <a href="https://github.com/seatgeek/fuzzywuzzy">fuzzywuzzy</a> package to help identify which strings are closest to each other. This dataset is small enough that we could probably could correct errors by hand, but that approach doesn’t scale well.</p>
<blockquote class="blockquote">
<p><strong>Fuzzy matching:</strong> The process of automatically finding text strings that are very similar to the target string. In general, a string is considered “closer” to another one the fewer characters you’d need to change if you were transforming one string into another. So “apple” and “snapple” are two changes away from each other (add “s” and “n”) while “in” and “on” and one change away (rplace “i” with “o”). You won’t always be able to rely on fuzzy matching 100%, but it will usually end up saving you at least a little time.</p>
</blockquote>
<p>Fuzzywuzzy returns a ratio given two strings. The closer the ratio is to 100, the smaller the edit distance between the two strings.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002035245766.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002035245766</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./image-20211002035303096.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">image-20211002035303096</figcaption><p></p>
</figure>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>