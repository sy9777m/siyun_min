---
title: "Co-op SAP Track 20220929 - INTERNAL TABLE DELETE"
author: "Siyun Min"
date: "2022-09-29"
categories: [SSU, SAP]
---
# 20220929 - INTERNAL TABLE DELETE

# in-class practice

1. 주문내역에서 정보를 가져와 특별구매기간 2022년 9월 16일부터 20일까지 가장 먼저 주문한 고객에게 사은품을 제공하는 로직을 구현
2. 배송내역에서 정보를 가져와 구매한 ID별 제품이 2개 이상이면 사은품 체크: ‘X’
    - 단, 배송상태가 배송 중이면 제외

```abap
SELECT ZID, ZNAME, ZZ_STATUS FROM ZEDU15_002 INTO CORRESPONDING FIELDS OF TABLE GT_GIFT
```

```abap
* 1
DATA: BEGIN OF GT_ORDERGIFT OCCURS 0.
  INCLUDE TYPE ZEDU15_001.
  DATA: ZGIFT TYPE C,
END OF GT_ORDERGIFT.

SELECT * FROM ZEDU15_001 INTO CORRESPONDING FIELDS OF TABLE GT_ORDERGIFT.

*BREAK-POINT.

LOOP AT GT_ORDERGIFT.
  IF ( GT_ORDERGIFT-Z_JDATE >= '20220916' ) AND ( GT_ORDERGIFT-Z_JDATE <= '20220920' ).
    GT_ORDERGIFT-ZGIFT = 'X'.
    MODIFY GT_ORDERGIFT.
  ENDIF.
  CLEAR: GT_ORDERGIFT.
ENDLOOP.

* 2
DATA: BEGIN OF GT_GIFT OCCURS 0.
  DATA: ZID TYPE ZEDU15_002-ZID,
        ZNAME TYPE ZEDU15_002-ZNAME,
        ZZ_STATUS TYPE ZEDU15_002-ZZ_STATUS,
        ZGIFT TYPE C,
END OF GT_GIFT.

SELECT * FROM ZEDU15_002 INTO CORRESPONDING FIELDS OF TABLE GT_GIFT.

*BREAK-POINT.

SORT GT_GIFT BY ZID.
DATA: ZCOUNT TYPE I VALUE 0.

LOOP AT GT_GIFT.
  ZCOUNT = ZCOUNT + 1.
  AT END OF ZID.
    IF ZCOUNT >= 2.
      GT_GIFT-ZGIFT = 'X'.
      MODIFY GT_GIFT TRANSPORTING ZGIFT WHERE ( ZID = GT_GIFT-ZID ) AND ( ZZ_STATUS = '1' ).
    ENDIF.
    ZCOUNT = 0.
  ENDAT.

  CLEAR: GT_GIFT.
ENDLOOP.
```

# INTERNAL TABLE 삭제 - DELETE

1. LOOP를 통한 라인 삭제
2. TABLE KEY를 이용해 라인 삭제
3. WHERE 조건을 이용해 라인 삭제
4. INDEX를 이용해 라인 삭제
5. ADJACENT DUPLICATE 구문을 이용해 중복 라인 삭제

## LOOP를 통한 라인 삭제

![Untitled](./Untitled.png)

![Untitled](./Untitled%201.png)

![Untitled](./Untitled%202.png)

![Untitled](./Untitled%203.png)

![Untitled](./Untitled%204.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-04'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.

BREAK-POINT.

LOOP AT GT_STUDENT INTO GS_STUDENT.
  IF GS_STUDENT-ZGUBUN NE 'M'.
    DELETE TABLE GT_STUDENT FROM GS_STUDENT.
  ENDIF.
  CLEAR: GS_STUDENT.
ENDLOOP.

BREAK-POINT.
```

![Untitled](./Untitled%205.png)

![Untitled](./Untitled%206.png)

## TABLE KEY를 이용해 라인 삭제

KEY 값 기준으로 INTERNAL TABLE의 라인 삭제

```abap
DELETE TABLE ITAB WITH TABLE KEY F1.
```

![Untitled](./Untitled%207.png)

![Untitled](./Untitled%208.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15 WITH NON-UNIQUE KEY ZGUBUN.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-04'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.

BREAK-POINT.

DELETE TABLE GT_STUDENT WITH TABLE KEY ZGUBUN = 'M'.

BREAK-POINT.
```

![Untitled](./Untitled%209.png)

![Untitled](./Untitled%2010.png)

## WHERE 조건을 이용해 라인 삭제

WHERE 조건절 기준으로 INTERNAL TABLE 라인 삭제

```abap
DELETE ITAB WHERE FIELD = VALUE.
```

![Untitled](./Untitled%2011.png)

![Untitled](./Untitled%2012.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-04'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.

BREAK-POINT.

DELETE GT_STUDENT WHERE ZGUBUN = 'M'.

BREAK-POINT.
```

![Untitled](./Untitled%2013.png)

![Untitled](./Untitled%2014.png)

## INDEX를 이용해 라인 삭제

INDEX를 이용하여 해당 라인의 값을 삭제

```abap
DELETE ITAB INDEX idx.

DELETE ITAB FROM N1 TO N2. "N1 ~ N2 라인 삭제
DELETE ITAB FROM N1. "N1 이후 모든 라인 삭제
DELETE ITAB TO N2. "첫 번째부터 N2까지 모든 라인 삭제

```

![Untitled](./Untitled%2015.png)

![Untitled](./Untitled%2016.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-04'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.

BREAK-POINT.

DELETE GT_STUDENT INDEX 2.

BREAK-POINT.
```

![Untitled](./Untitled%2017.png)

![Untitled](./Untitled%2018.png)

![Untitled](./Untitled%2019.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-04'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.

BREAK-POINT.

*DELETE GT_STUDENT INDEX 2.
DELETE GT_STUDENT FROM 2 TO 3.

BREAK-POINT.
```

![Untitled](./Untitled%2020.png)

![Untitled](./Untitled%2021.png)

![Untitled](./Untitled%2022.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-04'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.

BREAK-POINT.

*DELETE GT_STUDENT INDEX 2.
DELETE GT_STUDENT FROM 2.

BREAK-POINT.
```

![Untitled](./Untitled%2023.png)

![Untitled](./Untitled%2024.png)

![Untitled](./Untitled%2025.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-04'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.

BREAK-POINT.

*DELETE GT_STUDENT INDEX 2.
DELETE GT_STUDENT TO 2.

BREAK-POINT.
```

![Untitled](./Untitled%2026.png)

![Untitled](./Untitled%2027.png)

## ADJACENT DUPLICATE 구문을 이용해 중복 라인 삭제

이 구문은 수행하기 전에 반드시 SORT 구문을 통해 정렬해야 원하는 결과를 수행

```abap
DELETE ADJACENT DUPLICATE ENTRIES FROM ITAB.
DELETE ADJACENT DUPLICATE ENTRIES FROM ITAB COMPARING F1.
```

COMPARING 하지 않으면 TABLE KEY 값이 중복된 데이터 삭제

KEY 값을 만약 선언하지 않은 경우 문자열의 선행 필드들이 DEFAULT KEY로 구성

![Untitled](./Untitled%2028.png)

![Untitled](./Untitled%2029.png)

![Untitled](./Untitled%2030.png)

![Untitled](./Untitled%2031.png)

![Untitled](./Untitled%2032.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.
SORT GT_STUDENT.

BREAK-POINT.

DELETE ADJACENT DUPLICATES FROM GT_STUDENT.

BREAK-POINT.
```

![Untitled](./Untitled%2033.png)

![Untitled](./Untitled%2034.png)

![Untitled](./Untitled%2035.png)

![Untitled](./Untitled%2036.png)

![Untitled](./Untitled%2037.png)

![Untitled](./Untitled%2038.png)

```abap
DATA: GS_STUDENT TYPE ZSTU_15.
DATA: GT_STUDENT TYPE TABLE OF ZSTU_15.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '오해원'.
GS_STUDENT-ZENAME = 'Haewon Oh'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-0000-0000'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-02'.
GS_STUDENT-ZKNAME = '지수'.
GS_STUDENT-ZENAME = 'Jisu'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-1111-1111'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-03'.
GS_STUDENT-ZKNAME = '레아'.
GS_STUDENT-ZENAME = 'Lea'.
GS_STUDENT-ZGUBUN = 'F'.
GS_STUDENT-ZTEL = '000-2222-2222'.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-ZCODE = 'SSU-01'.
GS_STUDENT-ZKNAME = '이병헌'.
GS_STUDENT-ZENAME = 'Byeongheon Lee'.
GS_STUDENT-ZGUBUN = 'M'.
GS_STUDENT-ZTEL = '000-3333-3333'.

APPEND GS_STUDENT TO GT_STUDENT.

CLEAR: GS_STUDENT.
SORT GT_STUDENT.

BREAK-POINT.

DELETE ADJACENT DUPLICATES FROM GT_STUDENT COMPARING ZCODE.

BREAK-POINT.
```

![Untitled](./Untitled%2039.png)

![Untitled](./Untitled%2040.png)